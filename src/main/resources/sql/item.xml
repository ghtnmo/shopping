<?xml version="1.0" encoding="UTF-8" ?>
 <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="item">
    
    <insert id="insertItem" parameterType="item">
    	<![CDATA[
        insert into t_item (item_code,item_title,item_price,item_discount,item_stock,item_description,item_thumbnail,item_cdate)
        values ( t_item_code_seq.nextval, #{item_title},#{item_price},#{item_discount},#{item_stock},#{item_description},#{item_thumbnail},sysdate)
        ]]>
    </insert>
	
	<select id="listItem" parameterType="hashmap" resultType="item">
		<![CDATA[
		select rownum,a.item_code,a.item_title,a.item_price,a.item_discount,a.item_stock,a.item_cdate,b.image_name as item_thumbnail,des as item_description 
		from 
		    (select x.*,y.image_name as des,ROW_NUMBER() OVER(order by x.item_code desc) rn
		    from t_item x 
		        ,t_image y 
		    where x.item_description = y.image_code
		    ) a 
		    ,t_image b 
		where a.item_thumbnail = b.image_code
		and rn>=#{startNum}
		and rn<=#{endNum}
		]]>
	</select>
	
	<select id="listItemCount" resultType="Integer">
		<![CDATA[
		select count(*) from t_item
		]]>
	</select>
</mapper>



